import time
import random
import sys
import pandas as pd

def get_users():
    cantidad = int(input("Ingrese la cantidad de jugadores, debe ser menor o igual a cinco (5): "))
    if cantidad > 5 or cantidad <= 0 :
        cantidad =  input("Vuelva a ingresar un numero valido")
    
    iteraciones = int(input("Ingrese la cantidad de interaciones que requiere para analizar los resutados: "))
    if iteraciones <= 0 :
        iteraciones =  input("Vuelva a ingresar un numero valido")
        
    return cantidad, iteraciones


MAX_VAL = 100
DICE_FACE = 6

# snake takes you down from 'key' to 'value'
snakes = {
    16: 6,
    47: 26,
    49: 11,
    56: 53,
    62: 19,
    64: 60,
    87: 24,
    93: 73,
    95: 75,
    98: 78
}

# ladder takes you up from 'key' to 'value'
ladders = {
    1: 38,
    4: 14,
    9: 31,
    28: 84,
    21: 42,
    36: 44,
    51: 67,
    71: 91,
    80: 100
    
}

#Cantidad de jugadores
#Cantidad de partidas
cant,iteraciones = get_users()



#Para almacenar los valores crudos
lista_final = []

#Para almacenar cantidad de tiradas
lista_tiradas = []

#Para guardar la cantidad de rondas
lista_rondas=[]

for j in range(1,iteraciones):
    player1= 0
    player2= 0
    player3= 0
    player4= 0
    player5= 0
    
    valor=0
    turno=0
    lista= []
    
    while valor < MAX_VAL :
        turno = turno + 1
        
        #1 jugador
        if cant == 1:
            dado = random.randint(1, DICE_FACE)
            if player1+dado <= MAX_VAL :
                
                if (player1+dado) in snakes:
                        player1 = snakes.get(player1+dado)
                        lista.append(player1)
                        
                        
                elif (player1+dado) in ladders:
                        player1 = ladders.get(player1+dado)
                        lista.append(player1)
                        tiradas = (len(lista))
                        
                else:
                        player1 = (player1+dado)
                        lista.append(player1)
                        
                #Regla que si sale 6 vuelve a tirar
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player1 = MAX_VAL +(MAX_VAL- (player1+dado))
                lista.append(player1)
                
            if player1 >= valor:
                valor = player1
                ganador =" Jugador 1" 
                
    #2 jugadores
        if cant == 2:
            
            #tira jugador 1
            dado = random.randint(1, DICE_FACE)
            if player1+dado <= MAX_VAL :
                
                if (player1+dado) in snakes:
                        player1 = snakes.get(player1+dado)
                        lista.append(player1)
                        
                elif (player1+dado) in ladders:
                        player1 = ladders.get(player1+dado)
                        lista.append(player1)
                        
                else:
                        player1 = (player1+dado)
                        lista.append(player1)
                        
                if dado == 6:
                    player1=(player1+dado)
                             
            else:
                player1 = MAX_VAL +(MAX_VAL- (player1+dado))
                lista.append(player1)
                
            #tira jugador 2
            dado = random.randint(1, DICE_FACE)
            if player2+dado <= MAX_VAL :
                
                if (player2+dado) in snakes:
                        player2 = snakes.get(player2+dado)
                        lista.append(player2)
                        
                elif (player2+dado) in ladders:
                        player2 = ladders.get(player2+dado)
                        lista.append(player2)
                        
                else:
                        player2 = (player2+dado)
                        lista.append(player2)
                
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player2 = MAX_VAL +(MAX_VAL- (player2+dado))
                lista.append(player2)
                
            if player1 >= valor:
                valor = player1
                ganador =" Jugador 1"
                
            if player2 >= valor:
                valor = player2
                ganador =" Jugador 2"
                
                
    #3 jugadores
        if cant == 3:
            
            #tira jugador 1
            dado = random.randint(1, DICE_FACE)
            if player1+dado <= MAX_VAL :
                
                if (player1+dado) in snakes:
                        player1 = snakes.get(player1+dado)
                        lista.append(player1)
                        
                elif (player1+dado) in ladders:
                        player1 = ladders.get(player1+dado)
                        lista.append(player1)
                        
                else:
                        player1 = (player1+dado)
                        lista.append(player1)
                
                if dado == 6:
                    player1=(player1+dado)
                        
                        
            else:
                player1 = MAX_VAL +(MAX_VAL- (player1+dado))
                lista.append(player1)
                
            #tira jugador 2
            dado = random.randint(1, DICE_FACE)
            if player2+dado <= MAX_VAL :
                
                if (player2+dado) in snakes:
                        player2 = snakes.get(player2+dado)
                        lista.append(player2)
                        
                elif (player2+dado) in ladders:
                        player2 = ladders.get(player2+dado)
                        lista.append(player2)
                        
                else:
                        player2 = (player2+dado)
                        lista.append(player2)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player2 = MAX_VAL +(MAX_VAL- (player2+dado))
                lista.append(player2)
                
            #tira jugador 3
            dado = random.randint(1, DICE_FACE)
            if player3+dado <= MAX_VAL :
                
                if (player3+dado) in snakes:
                        player3 = snakes.get(player3+dado)
                        lista.append(player3)
                        
                elif (player3+dado) in ladders:
                        player2 = ladders.get(player3+dado)
                        lista.append(player3)
                        
                else:
                        player3 = (player3+dado)
                        lista.append(player3)
                        
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player3 = MAX_VAL +(MAX_VAL- (player3+dado))
                lista.append(player3)
                
            if player1 >= valor:
                valor = player1
                ganador =" Jugador 1"
                
            if player2 >= valor:
                valor = player2
                ganador =" Jugador 2"
                
            if player3 >= valor:
                valor = player3
                ganador =" Jugador 3"
                
    #4 jugadores
        if cant == 4:
            
            #tira jugador 1
            dado = random.randint(1, DICE_FACE)
            if player1+dado <= MAX_VAL :
                
                if (player1+dado) in snakes:
                        player1 = snakes.get(player1+dado)
                        lista.append(player1)
                        
                elif (player1+dado) in ladders:
                        player1 = ladders.get(player1+dado)
                        lista.append(player1)
                        
                else:
                        player1 = (player1+dado)
                        lista.append(player1)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player1 = MAX_VAL +(MAX_VAL- (player1+dado))
                lista.append(player1)
                
            #tira jugador 2
            dado = random.randint(1, DICE_FACE)
            if player2+dado <= MAX_VAL :
                
                if (player2+dado) in snakes:
                        player2 = snakes.get(player2+dado)
                        lista.append(player2)
                        
                elif (player2+dado) in ladders:
                        player2 = ladders.get(player2+dado)
                        lista.append(player2)
                        
                else:
                        player2 = (player2+dado)
                        lista.append(player2)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player2 = MAX_VAL +(MAX_VAL- (player2+dado))
                lista.append(player2)
                
            #tira jugador 3
            dado = random.randint(1, DICE_FACE)
            if player3+dado <= MAX_VAL :
                
                if (player3+dado) in snakes:
                        player3 = snakes.get(player3+dado)
                        lista.append(player3)
                        
                elif (player3+dado) in ladders:
                        player3 = ladders.get(player3+dado)
                        lista.append(player3)
                        
                else:
                        player3 = (player3+dado)
                        lista.append(player3)
                        
                if dado == 6:
                    player1=(player1+dado)
            else:
                player3 = MAX_VAL +(MAX_VAL- (player3+dado))
                lista.append(player3)
            
            #tira jugador 4
            dado = random.randint(1, DICE_FACE)
            if player4+dado <= MAX_VAL :
                
                if (player4+dado) in snakes:
                        player4 = snakes.get(player4+dado)
                        lista.append(player4)
                        
                elif (player4+dado) in ladders:
                        player4 = ladders.get(player4+dado)
                        lista.append(player4)
                        
                else:
                        player4 = (player4+dado)
                        lista.append(player4)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player4 = MAX_VAL +(MAX_VAL- (player4+dado))
                lista.append(player4)
                
            if player1 >= valor:
                valor = player1
                ganador =" Jugador 1"
                
            if player2 >= valor:
                valor = player2
                ganador =" Jugador 2"
                
            if player3 >= valor:
                valor = player3
                ganador =" Jugador 3" 
                
            if player4 >= valor:
                valor = player3
                ganador =" Jugador 4"  
    
      #5 jugadores
        if cant == 5:
            
            #tira jugador 1
            dado = random.randint(1, DICE_FACE)
            if player1+dado <= MAX_VAL :
                
                if (player1+dado) in snakes:
                        player1 = snakes.get(player1+dado)
                        lista.append(player1)
                        
                elif (player1+dado) in ladders:
                        player1 = ladders.get(player1+dado)
                        lista.append(player1)
                        
                else:
                        player1 = (player1+dado)
                        lista.append(player1)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player1 = MAX_VAL +(MAX_VAL- (player1+dado))
                lista.append(player1)
                
            #tira jugador 2
            dado = random.randint(1, DICE_FACE)
            if player2+dado <= MAX_VAL :
                
                if (player2+dado) in snakes:
                        player2 = snakes.get(player2+dado)
                        lista.append(player2)
                        
                elif (player2+dado) in ladders:
                        player2 = ladders.get(player2+dado)
                        lista.append(player2)
                        
                else:
                        player2 = (player2+dado)
                        lista.append(player2)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player2 = MAX_VAL +(MAX_VAL- (player2+dado))
                lista.append(player2)
                
            #tira jugador 3
            dado = random.randint(1, DICE_FACE)
            if player3+dado <= MAX_VAL :
                
                if (player3+dado) in snakes:
                        player3 = snakes.get(player3+dado)
                        lista.append(player3)
                        
                elif (player3+dado) in ladders:
                        player3 = ladders.get(player3+dado)
                        lista.append(player3)
                        
                else:
                        player3 = (player3+dado)
                        lista.append(player3)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player3 = MAX_VAL +(MAX_VAL- (player3+dado))
                lista.append(player3)
            
            #tira jugador 4
            dado = random.randint(1, DICE_FACE)
            if player4+dado <= MAX_VAL :
                
                if (player4+dado) in snakes:
                        player4 = snakes.get(player4+dado)
                        lista.append(player4)
                        
                elif (player4+dado) in ladders:
                        player4 = ladders.get(player4+dado)
                        lista.append(player4)
                        
                else:
                        player4 = (player4+dado)
                        lista.append(player4)
                if dado == 6:
                    player1=(player1+dado)
                        
            else:
                player4 = MAX_VAL +(MAX_VAL- (player4+dado))
                lista.append(player4)
            
            #tira jugador 5
            dado = random.randint(1, DICE_FACE)
            if player5+dado <= MAX_VAL :
                
                if (player5+dado) in snakes:
                        player5 = snakes.get(player5+dado)
                        lista.append(player5)
                        
                elif (player5+dado) in ladders:
                        player5 = ladders.get(player5+dado)
                        lista.append(player5)
                        
                else:
                        player5 = (player5+dado)
                        lista.append(player5)
                        
                if dado == 6:
                    player1=(player1+dado)
            else:
                player5 = MAX_VAL +(MAX_VAL- (player5+dado))
                lista.append(player5)
                
            if player1 >= valor:
                valor = player1
                ganador =" Jugador 1"
                
            if player2 >= valor:
                valor = player2
                ganador =" Jugador 2"
                
            if player3 >= valor:
                valor = player3
                ganador =" Jugador 3" 
                
            if player4 >= valor:
                valor = player4
                ganador =" Jugador 4"  
    
            if player4 >= valor:
                valor = player5
                ganador =" Jugador 5"
                
    #print(ganador)
    lista_final.append(lista)
    #lista cantidad de partidas
    lista_tiradas.append(len(lista))
    lista_rondas.append(turno)
    #print(lista)
    #print(turno)
    
datos = {
    'Valores_crudos' : lista_final,
    'Cantidad_de_rondas': lista_rondas,
    'Cantidad_de_tiradas': lista_tiradas,
    'Ganador': ganador,
    'Cantidad_jugadores': cant}

table = pd.DataFrame(datos)

print(table)

import os
os.chdir("C:/Users/DELL/Documents/itba")
table.to_csv("datostp-5.csv", sep=',',index=True,  index_label='Id')
